package io.jenkins.plugins.insightappsec.api.vulnerability;

import io.jenkins.plugins.insightappsec.api.scan.Scan;

import java.util.Arrays;

public class VulnerabilityModels {

    // EXCHANGE

    public static Vulnerability.Variance.Exchange.ExchangeBuilder anExchange() {
        return Vulnerability.Variance.Exchange.builder();
    }

    public static Vulnerability.Variance.Exchange.ExchangeBuilder aCompleteExchange() {
        return anExchange().request("request")
                           .response("response");
    }

    // VARIANCE

    public static Vulnerability.Variance.VarianceBuilder aVariance() {
        return Vulnerability.Variance.builder();
    }

    public static Vulnerability.Variance.VarianceBuilder aCompleteVariance() {
        return aVariance().originalValue("originalValue")
                          .originalExchange(aCompleteExchange().build())
                          .attackValue("attackValue")
                          .attackExchanges(Arrays.asList(aCompleteExchange().build(),
                                                         aCompleteExchange().build()))
                          .message("message");
    }

    // ROOT CAUSE

    public static Vulnerability.RootCause.RootCauseBuilder aRootCause() {
        return Vulnerability.RootCause.builder();
    }

    public static Vulnerability.RootCause.RootCauseBuilder aCompleteRootCause() {
        return aRootCause().url("http://url.com")
                           .parameter("parameter")
                           .method("POST");
    }

    // VULNERABILITY

    public static Vulnerability.VulnerabilityBuilder aVulnerability() {
        return Vulnerability.builder();
    }

    public static Vulnerability.VulnerabilityBuilder aCompleteVulnerability() {
        return aVulnerability().severity("HIGH")
                               .status(Scan.ScanStatus.COMPLETE.name())
                               .rootCause(aCompleteRootCause().build())
                               .variances(Arrays.asList(aCompleteVariance().build(),
                                                        aCompleteVariance().build()));
    }

}